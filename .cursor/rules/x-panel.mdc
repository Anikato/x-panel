---
name: x-panel
description: X-Panel æœåŠ¡å™¨ç®¡ç†é¢æ¿ - å…¨ AI è¾…åŠ©å¼€å‘é¡¹ç›®çš„å…¨å±€è§„åˆ™
globs:
alwaysApply: true
---

# X-Panel é¡¹ç›®è§„åˆ™

## é¡¹ç›®èº«ä»½

- X-Panel æ˜¯ä¸€ä¸ª Linux æœåŠ¡å™¨ç®¡ç†é¢æ¿ï¼Œå‚è€ƒ 1Panel é‡æ–°å®ç°
- **æ ¸å¿ƒå·®å¼‚ï¼šNginx åŸºäºæœ¬åœ°å®‰è£…ç®¡ç†ï¼Œä¸ä½¿ç”¨ Docker**
- å‚è€ƒæºç ï¼š`1Panel/` ç›®å½•ï¼ˆåªè¯»å‚è€ƒï¼Œç¦æ­¢ä¿®æ”¹ï¼‰
- è¯¦ç»†è®¾è®¡æ–‡æ¡£ï¼š`docs/development-guide.md`

## æŠ€æœ¯æ ˆ

| å±‚ | æŠ€æœ¯ |
|---|---|
| åç«¯ | Go 1.24+ / Gin / GORM / SQLite (glebarez/sqlite) |
| é…ç½® | Viper (YAML) |
| å‰ç«¯ | Vue 3 + TypeScript / Element Plus / Pinia / Vite |
| ç»ˆç«¯ | xterm.js + gorilla/websocket |
| å®¹å™¨ | Docker SDK (docker/docker) |
| SSL | go-acme/lego/v4 |
| ç›‘æ§ | shirou/gopsutil/v4 / ECharts 5 |

## æ¶æ„çº¦æŸ

### åˆ†å±‚è§„åˆ™
ä¸¥æ ¼å•å‘ä¾èµ–ï¼š`Router â†’ API(Handler) â†’ Service â†’ Repo â†’ Model`
- API å±‚ï¼šå‚æ•°æ ¡éªŒ + è°ƒç”¨ Service + ç»Ÿä¸€å“åº”ï¼Œä¸å«ä¸šåŠ¡é€»è¾‘
- Service å±‚ï¼šä¸šåŠ¡é€»è¾‘ï¼Œä¸ç›´æ¥æ“ä½œ HTTP ä¸Šä¸‹æ–‡
- Repo å±‚ï¼šçº¯æ•°æ®åº“ CRUD
- Model å±‚ï¼šGORM æ¨¡å‹å®šä¹‰ï¼Œä¸å«ä¸šåŠ¡æ–¹æ³•

### ç›®å½•ç»“æ„
åç«¯ `backend/`ï¼š`cmd/server/` | `server/` | `app/{api/v1, dto, model, repo, service}` | `router/` | `middleware/` | `global/` | `constant/` | `utils/` | `i18n/` | `init/` | `cron/`

å‰ç«¯ `frontend/src/`ï¼š`api/` | `components/` | `hooks/` | `layout/` | `routers/modules/` | `store/` | `views/{website,database,container,host,terminal,cronjob,toolbox,log,setting}` | `utils/`

### åˆå§‹åŒ–é¡ºåº
Viper â†’ Logger â†’ DB â†’ Migration â†’ Cache â†’ I18n â†’ Cron â†’ Firewall â†’ Router

## å…³é”®çº¦æŸ âš ï¸

1. **Nginx å¿…é¡»æœ¬åœ°ç®¡ç†**ï¼šsystemctl ç®¡æ§ï¼Œé…ç½®åœ¨ `/etc/nginx/`ï¼Œç¦æ­¢ Docker åŒ–
2. **Nginx å˜æ›´å®‰å…¨æ¨¡å¼**ï¼šä¿®æ”¹é…ç½® â†’ `nginx -t` æµ‹è¯• â†’ å¤±è´¥å›æ»š â†’ æˆåŠŸæ‰ `nginx -s reload`
3. **ä¸å®ç°çš„åŠŸèƒ½**ï¼šåº”ç”¨å•†åº—ã€Runtime ç®¡ç†ã€ç³»ç»Ÿå¿«ç…§ã€å¤‡ä»½è´¦å·ç®¡ç†
4. **1Panel ä»£ç ä»…å‚è€ƒ**ï¼šç¦æ­¢ç›´æ¥å¤åˆ¶ï¼Œéœ€å»é™¤ Docker Nginx ä¾èµ–åé‡å†™
5. **æ‰€æœ‰ç”¨æˆ·å¯è§æ–‡æœ¬å¿…é¡»èµ° i18n**ï¼šä¸ç¡¬ç¼–ç ä¸­è‹±æ–‡

## ç¼–ç è§„èŒƒ

### Go åç«¯
- æ–‡ä»¶å `snake_case.go`ï¼Œæ¥å£ `IXxxService`ï¼Œå®ç° `XxxService`
- æ‰€æœ‰ model ç»§æ‰¿ `BaseModel{ID, CreatedAt, UpdatedAt}`
- ç»Ÿä¸€å“åº” `Response{Code, Message, Data}` + åˆ†é¡µ `PageResult{Total, Items}`
- ä¸šåŠ¡é”™è¯¯ç”¨ `buserr.New("ErrKey")` åŒ…è£…ï¼Œæ”¯æŒ i18n
- æ¯ä¸ª Service å®šä¹‰æ¥å£ + ç§æœ‰å®ç° + `NewIXxxService()` å·¥å‚å‡½æ•°

### Vue å‰ç«¯
- ç»„ä»¶ä½¿ç”¨ `<script setup lang="ts">`ï¼ŒProps ç”¨ TypeScript æ¥å£
- è·¯ç”±æŒ‰æ¨¡å—æ‹†åˆ†ï¼š`routers/modules/{website,database,...}.ts`
- API æŒ‰æ¨¡å—å°è£…ï¼ŒAxios å®ä¾‹è‡ªåŠ¨é™„åŠ  JWTã€401 è·³ç™»å½•
- çŠ¶æ€ç®¡ç†ç”¨ Piniaï¼Œéœ€è¦æŒä¹…åŒ–çš„ store å¯ç”¨ `persist: true`

## å·¥ä½œæ—¥å¿— ğŸ“‹

- **æ—¥å¿—æ–‡ä»¶**ï¼š`docs/worklog.md`
- **æ›´æ–°æ—¶æœº**ï¼šæ¯æ¬¡ä¼šè¯å®Œæˆå®è´¨æ€§å·¥ä½œåï¼Œå¿…é¡»åœ¨æ—¥å¿—ä¸­è¿½åŠ è®°å½•
- **è®°å½•å†…å®¹**ï¼šæ—¥æœŸã€å®Œæˆå†…å®¹ï¼ˆchecklistï¼‰ã€å…³é”®å†³ç­–ã€é—ç•™é—®é¢˜ã€ä¸‹ä¸€æ­¥è®¡åˆ’
- **æ ¼å¼**ï¼šæŒ‰æ—¥æœŸå€’åºï¼Œæœ€æ–°è®°å½•åœ¨æœ€å‰é¢ï¼ˆç›®å½•ä¹‹åï¼‰

## GitHub ä»“åº“

- **ä»“åº“åœ°å€**ï¼š`https://github.com/Anikato/x-panel`ï¼ˆå…¬å¼€ä»“åº“ï¼‰
- **ç”¨æˆ·å**ï¼šAnikato
- **GitHub Token**ï¼šï¼ˆå·²ç§»é™¤ï¼Œè¯·å‹¿åœ¨å…¬å¼€ä»“åº“ä¸­å­˜æ”¾ Tokenï¼‰
- **SSH ç§é’¥**ï¼šå·²é…ç½®åœ¨ `/root/.ssh/id_rsa`
- **CI/CD**ï¼šGitHub Actions è‡ªåŠ¨æ„å»ºï¼ˆ`.github/workflows/release.yml`ï¼‰ï¼Œæ¨é€ `v*` tag è§¦å‘
- **ä¸€é”®å®‰è£…**ï¼š`scripts/install-online.sh`ï¼Œå…¬å¼€ä»“åº“ç›´æ¥ curl æ‰§è¡Œå³å¯

## ç‰ˆæœ¬å·è§„åˆ™ ğŸ“Œ

- **æ ¼å¼**ï¼šè¯­ä¹‰åŒ–ç‰ˆæœ¬ `vMAJOR.MINOR.PATCH`ï¼ˆå¦‚ `v0.3.1`ï¼‰
- **å‘å¸ƒæ–¹å¼**ï¼šæ¨é€ Git tag è§¦å‘ GitHub Actions è‡ªåŠ¨æ„å»ºå’Œå‘å¸ƒ
- **ç‰ˆæœ¬é€’å¢ç­–ç•¥**ï¼š
  - æ¯æ¬¡å‘å¸ƒå‡çº§ **æœ€å°ç‰ˆæœ¬å·ï¼ˆPATCHï¼‰**ï¼Œå¦‚ `v0.3.0` â†’ `v0.3.1` â†’ `v0.3.2`
  - æœ‰è¾ƒå¤§åŠŸèƒ½å˜æ›´æ—¶æ‰å‡çº§ MINOR ç‰ˆæœ¬ï¼Œå¦‚ `v0.3.x` â†’ `v0.4.0`
  - MAJOR ç‰ˆæœ¬å·åœ¨æ¶æ„é‡å¤§å˜æ›´æ—¶æ‰å‡çº§
- **å‘å¸ƒæµç¨‹**ï¼š
  1. æäº¤ä»£ç ï¼š`git add -A && git commit -m "æè¿°"`
  2. æ¨é€ä»£ç ï¼š`git push origin main`
  3. æ‰“ tagï¼š`git tag v0.x.x`
  4. æ¨é€ tagï¼š`git push origin v0.x.x`
- **ç‰ˆæœ¬æ³¨å…¥**ï¼šç¼–è¯‘æ—¶é€šè¿‡ `ldflags` å°† Git tag æ³¨å…¥ `version.Version` å˜é‡
- **âš ï¸ ç¦æ­¢è·³ç‰ˆæœ¬å·**ï¼šä¸å…è®¸ä» `v0.3.1` ç›´æ¥è·³åˆ° `v0.4.0` æˆ– `v1.0.0`ï¼Œé™¤éæœ‰å……åˆ†ç†ç”±

## å‚è€ƒ 1Panel æºç å¯¼èˆª

- Agent ç«¯ï¼ˆå®é™…æ‰§è¡Œå±‚ï¼‰ï¼š`1Panel/agent/app/service/` â€” ç½‘ç«™/æ•°æ®åº“/å®¹å™¨/ç³»ç»Ÿ/å·¥å…·ç®±
- Core ç«¯ï¼ˆç®¡æ§å±‚ï¼‰ï¼š`1Panel/core/app/service/` â€” è®¤è¯/è®¾ç½®/æ—¥å¿—/å¤šæœºç®¡ç†
- Nginx è§£æå™¨ï¼š`1Panel/agent/utils/nginx/` â€” å¯ç§»æ¤çš„çº¯ Go å®ç°
- SSL å·¥å…·ï¼š`1Panel/agent/utils/ssl/` â€” å¯ç§»æ¤çš„ ACME å®¢æˆ·ç«¯
- å‰ç«¯é¡µé¢ï¼š`1Panel/frontend/src/views/` â€” UI ç»“æ„å‚è€ƒ
